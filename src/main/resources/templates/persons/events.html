<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8"/>
	<meta content="width=device-width,initial-scale=1" name="viewport"/>
	<meta th:name="_csrf" th:value="${_csrf.token}"/>
	<title>Jane Doe | Adebar</title>
	<link rel="stylesheet" type="text/css" href="../../static/resources/css/bootstrap.min.css"
				th:href="@{/webjars/bootstrap/css/bootstrap.min.css}"/>

	<link rel="stylesheet" type="text/css" href="../../static/resources/css/style.css"
				th:href="@{/resources/css/style.css}"/>
	<link rel="stylesheet" type="text/css" href="../../static/resources/css/personDetails.css"
				th:href="@{/resources/css/personDetails.css}"/>
	<link rel="stylesheet" type="text/css" href="../../static/resources/css/timeline.css"
				th:href="@{/resources/css/timeline.css}"/>
</head>
<body>

<!-- central navigation -->
<nav th:replace="navigation :: topNav(page='persons')"></nav>

<!-- page specific content-->
<main id="main">

	<a href="persons.html">
		<span class="glyphicon glyphicon-chevron-left"></span>
		Zurück zur Übersicht
	</a>

	<h1>Profil von Jane Doe</h1>

	<ul class="nav nav-tabs" role="tablist">
		<li role="presentation" class="active">
			<a href="#overview" class="tab-controller" aria-controls="general" role="tab"
				 data-toggle="tab">Allgemeine Infos</a>
		</li>
		<li role="presentation">
			<a href="#activist-referent" class="tab-controller" aria-controls="activist-referent"
				 role="tab" data-toggle="tab">Aktiven + Referenteninfos</a>
		</li>
		<li role="presentation">
			<a href="#events" class="tab-controller" aria-controls="events" role="tab" data-toggle="tab">Teilgenommene
				Veranstaltungen</a>
		</li>
		<li role="presentation">
			<a href="#newsletters" class="tab-controller" aria-controls="newsletters" role="tab"
				 data-toggle="tab">Newsletter</a>
		</li>
	</ul>

	<article class="tab-content">

		<!-- events -->
		<div id="overview" class="tab-pane active container-fluid" role="tabpanel">

			<section id="timeline" class="display-category">

				<div th:fragment="timeline">

					<h2>Veranstaltungs-Timeline</h2>

					<div class="container-fluid">
						<div class="row">

							<!-- add participation -->
							<div class="col-md-5 col-md-push-7">

								<div class="row margin-btm"
										 th:if="${param.add != null and param.add[0] == 'failed'}">

									<div class="panel panel-danger">
										<div class="panel-heading">
											<h3 class="panel-title">Die Person konnte zu einigen Veranstaltungen nicht
												hinzugefügt werden:</h3>
										</div>
										<div class="panel-body">
											<p>
												Eventuell ist die Veranstaltung bereits <strong>ausgebucht</strong> oder das
												<strong>Mindest-Teilnahmealter</strong> stimmt nicht? Auch das Geschlecht
												muss für
												Bitte versuche den/die Teilnehmende*n in den Veranstaltungsdetails nochmal
												hinzuzufügen (und bspw. den Teilnahmezeitraum zu verändern).
											</p>
											<strong>Folgende Veranstaltungen sind betroffen:</strong>
										</div>
										<div class="list-group" th:remove="all-but-first"
												 th:if="${failedParticipations != null}">
											<a href="../eventDetails.html" class="list-group-item"
												 th:each="fe : ${failedParticipations.keySet()}"
												 th:href="@{/events/{id}(id=${fe.id})}" th:inline="text">[[${fe.name}]]
												<small
														th:text="|(${#time.formatTimeSpan(fe.getStartTime(), fe.getEndTime())})|">
													(09.-13.05.18)
												</small>
												<span class="glyphicon glyphicon-baby-formula" data-toggle="tooltip"
															data-placement="bottom" data-title="Zu jung"
															th:if="${failedParticipations.get(fe).name() == 'TOO_YOUNG'}"></span>
												<span class="glyphicon glyphicon-bed" data-toggle="tooltip"
															data-placement="bottom" data-title="Ausgebucht"
															th:if="${failedParticipations.get(fe).name() == 'BOOKED_OUT'}"></span></a>
											<a href="../eventDetails.html" class="list-group-item">Bergwiesencamp
												<small>(28.07.-11.08.18)</small>
											</a>
										</div>
									</div>


								</div>


								<div class="row margin-btm">
									<div class="col-md-5">
										<button type="button" class="btn btn-primary" data-toggle="modal"
														data-target="#add-participations-dialog">
											<span class="glyphicon glyphicon-plus"></span>
											Teilnahme hinzufügen
										</button>

										<!-- select events dialog -->
										<div class="modal fade" id="add-participations-dialog" tabindex="-1"
												 role="dialog">
											<div class="modal-dialog modal-lg" role="document">
												<div class="modal-content">
													<div class="modal-header">
														<button type="button" class="close" data-dismiss="modal">
															&times;
														</button>
														<h3 class="modal-title">Teilnahme hinzufügen</h3>
													</div>
													<div class="modal-body modal-body-scrollable">
														<form id="add-participations" method="post"
																	th:action="@{/persons/{id}/events/add(id=${person.id})}">
															<div class="form-group">
																<div class="container-fluid">
																	<div class="row">
																		<div class="col-md-8 col-md-offset-1">
																			<label for="event-filter" class="control-label">Suche</label>
																			<div class="input-group">
																				<input type="search" id="event-filter"
																							 class="form-control fuzzy-search"
																							 placeholder="Nach Veranstaltung suchen"/>
																				<span class="input-group-addon">
                                          <span class="glyphicon glyphicon-search"></span>
                                        </span>
																			</div>
																		</div>
																	</div>
																</div>
															</div>
															<hr/>
															<div class="form-group">
																<table id="select-events" class="table table-striped table-hover">
																	<thead>
																	<tr class="row">
																		<th class="col-md-1"></th>
																		<th class="col-md-3">Veranstaltung</th>
																		<th class="col-md-3">Zugehörig</th>
																		<th class="col-md-2">Zeitraum</th>
																		<th class="col-md-3">Ort</th>
																	</tr>
																	</thead>
																	<tbody class="events" th:remove="all-but-first">
																	<tr class="row propagate-click action-cursor"
																			data-propagation-target=":checkbox"
																			th:each="event : ${futureEvents}">
																		<td class="col-md-1">
																			<input type="checkbox" name="event-ids"
																						 th:value="${event.id}"/>
																		</td>
																		<td class="col-md-3 name" th:text="${event.name}">Wildniscamp
																		</td>
																		<td class="col-md-2 belonging">
																			<a href="../localGroupDetails.html"
																				 class="label label-default"
																				 th:if="${event.forLocalGroup}"
																				 th:href="@{/localGroups/{id}(id=${event.localGroup.id})}"
																				 th:text="${event.localGroup.name}">
																				NAJU Dresden
																			</a>
																			<a href="../projectDetails.html"
																				 class="label label-info"
																				 th:if="${event.forProject}"
																				 th:href="@{/projects/{id}(id=${event.project.id})}"
																				 th:text="${event.project.name}">
																				Puppenstuben gesucht!
																			</a>
																		</td>
																		<td class="col-md-3 time"
																				th:text="${{#time.formatTimeSpan(event.getStartTime(), event.getEndTime())}}">
																			04.-09.06.
																		</td>
																		<td class="col-md-3 place" th:text="${event.place.city}">
																			Dachsenberg
																		</td>
																	</tr>
																	<tr class="row propagate-click"
																			data-propagation-target=":checkbox">
																		<td class="col-md-1">
																			<input type="checkbox" name="event-ids"/>
																		</td>
																		<td class="col-md-3">Bergwiesencamp</td>
																		<td class="col-md-2">
																			<span class="label label-default">NAJU Sachsen</span>
																		</td>
																		<td class="col-md-3">
																			25.07.-09.08.
																		</td>
																		<td class="col-md-3">
																			Oberwiesenthal
																		</td>
																	</tr>
																	</tbody>
																</table>
															</div>
														</form>
														<hr/>
														<p class="help-block">
															Falls die Veranstaltung eine Anpassung des Teilnahmezeitraums erlaubt,
															wird
															der/die Teilnehmende für die vollständige Dauer hinzugefügt. (Das
															lässt
															sich später in den Veranstaltungsdetails ändern)
														</p>
													</div>
													<div class="modal-footer">
														<button type="button" class="btn btn-default" data-dismiss="modal">
															Abbrechen
														</button>
														<button type="submit" form="add-participations" class="btn btn-primary">
															Fertig
														</button>
													</div>
												</div>
											</div>
										</div>

										<div class="checkbox margin-top-lg">
											<label>
												<input type="checkbox" checked="true" id="toggle-participant"/> normale
												Teilnahmen anzeigen
											</label>
										</div>
										<div class="checkbox margin-btm">
											<label>
												<input type="checkbox" checked="true" id="toggle-counselor"/> Teilnahmen als
												Betreuer*in
												anzeigen
											</label>
										</div>

									</div>
								</div>

								<!-- timeline anchors -->
								<div class="row" th:if="${participationTimeline}">
									<div class="col-md-5">
										<div class="panel panel-default">
											<div class="panel-heading">
												<h3 class="panel-title">Springe zu:</h3>
											</div>
											<div class="list-group" th:remove="all-but-first">
												<a href="#events-2018" class="list-group-item"
													 th:each="year : ${participationTimeline.participationYears}"
													 th:href="'#events-' + ${year}"
													 th:inline="text">
													<span class="glyphicon glyphicon-chevron-right"></span> [[${year}]]
												</a>
												<a href="#events-2017" class="list-group-item">
													<span class="glyphicon glyphicon-chevron-right"></span> 2017
												</a>
											</div>
										</div>
									</div>
								</div>

							</div>
							<div class="col-md-7 col-md-pull-5">

								<div class="row"
										 th:if="${participationTimeline != null and not participationTimeline.isEmpty()}">
									<p class="">
										<em th:text="${person.name}">Jane Doe</em> hat an folgenden Veranstaltungen
										teilgenommen:
									</p>
								</div>

								<!-- timeline -->
								<div class="row"
										 th:if="${participationTimeline != null and not participationTimeline.isEmpty()}">
									<div id="event-participation-timeline" class="timeline" th:remove="all-but-first">
										<div class="timeline-year" th:each="entry : ${participationTimeline}">
											<div class="timeline-group-wrapper">
												<div class="timeline-group">
													<h4 id="events-2018" th:id="|events-${entry.year}|"
															th:text="${entry.year}">2018</h4>
												</div>
											</div>
											<div class="timeline-entry-wrapper" th:each="event : ${entry.events}"
													 th:classappend="${entry.wasCounselorFor(event) ? 'counselor' : 'participant'}">
												<div class="timeline-entry" th:inline="text">
                        <span class="glyphicon glyphicon-road" data-toggle="tooltip"
															data-placement="bottom" title="zukünftige Veranstaltung!"
															th:if="${event.prospective}"></span>
													<span class="glyphicon glyphicon-wrench" data-toggle="tooltip"
																data-placement="bottom" title="als Betreuer*in"
																th:if="${entry.wasCounselorFor(event)}"></span>
													<a href="../eventDetails.html"
														 th:href="@{/events/{id}(id=${event.id})}" th:text="${event.name}">
														Paddelcamp
													</a> ([[${{#time.formatTimeSpan(event.getStartTime(),
													event.getEndTime())}}]])
												</div>
											</div>
										</div>
										<div class="timeline-year">
											<div class="timeline-entry-wrapper">
												<div class="timeline-entry">
													<span class="glyphicon"></span>
													<a href="../eventDetails.html">Himmelfahrtscamp</a> (14.-19.05.)
												</div>
											</div>
										</div>
										<div class="timeline-group-wrapper">
											<div class="timeline-group">
												<h4 id="events-2017">2017</h4>
											</div>
										</div>
										<div class="timeline-entry-wrapper">
											<div class="timeline-entry">
												<a href="../eventDetails.html">Ideenwerkstatt</a> (21.-23.10.)
											</div>
										</div>
										<div class="timeline-entry-wrapper">
											<div class="timeline-entry">
												<a href="../eventDetails.html">Bergwiesencamp</a> (25.07.-14.08.)
											</div>
										</div>
									</div>
								</div>

								<div class="row margin-top-lg"
										 th:unless="${participationTimeline != null and not participationTimeline.isEmpty()}">
									Bisher hat die Person noch an keinen Veranstaltungen teilgenommen.
								</div>

							</div>
						</div>
					</div>

				</div>


			</section>

		</div>

	</article>

</main>

<form id="logout-user" method="POST" th:action="@{/logout}">
	<input type="hidden" name="csrf" th:value="csrf"/>
</form>

<script type="text/javascript" src="../../static/resources/js/jquery.min.js"
				th:src="@{/webjars/jquery/jquery.min.js}"></script>
<script type="text/javascript" src="../../static/resources/js/bootstrap.min.js"
				th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
<script type="text/javascript" src="../../static/resources/js/bootstrap-select.min.js"
				th:src="@{/resources/js/bootstrap-select.min.js}"></script>
<script src="../../static/resources/js/init.js" th:src="@{/resources/js/init.js}"></script>
<script src="../../static/resources/js/formControls.js"
				th:src="@{/resources/js/formControls.js}"></script>
<script src="../../static/resources/js/participationTimeline.js"
				th:src="@{/resources/js/participationTimeline.js}"></script>

</body>
</html>
